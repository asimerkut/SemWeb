<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui" xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:sec="http://www.springframework.org/security/tags">


<h:form>
	<p:menubar styleClass="menuStyle" >
		<p:submenu label="Sistem Yonetimi" rendered="#{sec:areAnyGranted('AUTH_SECURITY,AUTH_ORGANIZATION,AUTH_DEFINITION')}">
			<p:menuitem value="Organizasyon Tanimlari" url="/app/organization/orgmanager.abc" rendered="#{sec:areAnyGranted('AUTH_ORGANIZATION')}" />
			<p:menuitem value="Kullanici Tanimlari" url="/app/user/usermanager.abc" rendered="#{sec:areAnyGranted('AUTH_SECURITY')}"/>
			<p:menuitem value="Kullanici Gruplari" url="/app/user/rolemanager.abc" rendered="#{sec:areAnyGranted('AUTH_SECURITY')}" />			
			<p:menuitem value="Parametre Tanimlari" url="/app/definition/defmanager.abc?grp=PRM" rendered="#{sec:areAnyGranted('AUTH_DEFINITION')}"/>
			<p:menuitem value="Kod Tanimlari" url="/app/definition/defmanager.abc?grp=VAL" rendered="#{sec:areAnyGranted('AUTH_DEFINITION')}"/>
			<p:menuitem value="Hesap Tipleri" url="/app/definition/defmanager.abc?grp=ITM" rendered="#{sec:areAnyGranted('AUTH_DEFINITION')}"/>
			<p:menuitem value="Stok Gorev Tanimlari" url="/app/definition/defmanager.abc?grp=STK" />
			<p:menuitem value="Finans Gorev Tanimlari" url="/app/definition/defmanager.abc?grp=FIN" />
			<p:menuitem value="Birim Tanimlari" url="/app/definition/unitmanager.abc" />
			<p:menuitem value="Test" url="/app/test/testmanager.abc" />
		</p:submenu>

		<p:submenu label="Tanimlar" rendered="#{sec:areAnyGranted('AUTH_DEFINITION')}">
			<p:menuitem value="Malzeme Tanimlari" url="/app/definition/defItem.abc?type=ITM_SR_ST&amp;class=STK_M" />   
			<p:menuitem value="Yemek Tanimlari" url="/app/definition/defItem.abc?type=ITM_SR_ST&amp;class=STK_P" />
			<p:menuitem value="Menu Tanimlari" url="/app/catering/menu.abc" />
		</p:submenu>

		<p:submenu label="Islemler" rendered="#{sec:areAnyGranted('AUTH_NONE')}">
			<p:menuitem value="Depo Islemleri" url="/app/transaction/findStockDocument.abc" />
			<p:menuitem value="Finans Islemleri" url="/app/index.abc?faces-redirect=true" />
		</p:submenu>

		<p:submenu label="Raporlar" rendered="#{sec:areAnyGranted('AUTH_NONE')}">
			<p:menuitem value="Stok RaporlarÄ±" url="/app/index.abc?faces-redirect=true" />
		</p:submenu>

		<f:facet name="options">
			<h:form>
				<p:button value="Giris" href="/app/user/login.abc" icon="ui-icon-tag" rendered="#{empty request.remoteUser}" />

				<h:panelGrid columns="3" rendered="#{not empty request.remoteUser}">
					
					<p:selectOneMenu value="#{sessionInfoHelper.currentUser().selectedOrganization}" converter="omnifaces.SelectItemsConverter" style="width:200px">
						<f:selectItems value="#{sessionInfoHelper.currentUser().organizationList}" var="organization" itemLabel="#{organization.id}: #{organization.name}" itemValue="#{organization}" />
						<p:ajax event="change" process="@this" listener="#{sessionInfoHelper.companyChanged()}" update="menu_fiscal_year_combo" />
					</p:selectOneMenu>
					
					<p:selectOneMenu id="menu_fiscal_year_combo" value="#{sessionInfoHelper.currentUser().selectedFiscalYear}" converter="omnifaces.SelectItemsConverter" style="width:200px">
						<f:selectItems value="#{sessionInfoHelper.currentUser().companyFiscalYearSet}" var="fiscalYear" itemLabel="#{fiscalYear.year}" itemValue="#{fiscalYear}" />
						<p:ajax event="change" process="@this" listener="#{sessionInfoHelper.fiscalYearChanged()}" />
					</p:selectOneMenu>

					<p:menuButton value="#{request.remoteUser}" style="text-transform:capitalize;">
						<p:menuitem value="Cikis" url="/app/logout" icon="ui-icon-extlink" />
					</p:menuButton>
				</h:panelGrid>
			</h:form>
		</f:facet>

	</p:menubar>
</h:form>

</html>
