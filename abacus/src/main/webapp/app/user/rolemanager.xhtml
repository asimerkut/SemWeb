<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	template="/WEB-INF/content/template/simple.xhtml">

	<ui:define name="content">

		<style>
.topAligned {
	vertical-align: top;
}

.ui-picklist .ui-picklist-list {
    width: 300px;
}
</style>

		<h:panelGrid columns="2" style="width:100%;"
			columnClasses="topAligned">

			<h:panelGrid style="width:400px;">

				<h:form id="groupListForm">

					<p:dataTable id="groupListDataTable" var="group"
						value="#{userGroupViewBean.findAllGroups()}"
						selection="#{userGroupViewBean.selectedGroup}"
						selectionMode="single">

						<p:ajax event="rowSelect"
							listener="#{userGroupViewBean.onGroupRowSelected}"
							update=":groupDetailForm:groupDetailPanel" />

						<p:column headerText="Grup">  
	            			#{group.name}  
	        			</p:column>

						<f:facet name="footer">
							<p:commandButton value="Ekle" actionListener="#{userGroupViewBean.newGroup}" update=":groupDetailForm:groupDetailPanel" />
							<p:spacer width="5px" />
							<p:commandButton value="Sil" ajax="true" actionListener="#{userGroupViewBean.removeGroup}"  update=":groupDetailForm:groupDetailPanel :groupListForm:groupListDataTable" />
						</f:facet>
 
					</p:dataTable>

				</h:form>
			</h:panelGrid>

			<p:panel header="Detay" style="width:800px;">

				<h:form id="groupDetailForm">

					<h:panelGrid id="groupDetailPanel" columns="2">

						<h:outputText value="Grup Adi" style="font-weight:bold" />
						<p:inputText value="#{userGroupViewBean.selectedGroup.name}" />


						<h:outputText value="Yetkiler" style="font-weight:bold" />

						<p:pickList  
							value="#{userGroupViewBean.selectedGroupAuthoritiesDL}"
							var="authority" itemValue="#{authority}"
							itemLabel="#{authority.id}" converter="authorityEntityConverter"
							showCheckbox="true" showSourceFilter="true"
							showTargetFilter="true" filterMatchMode="contains">

							<f:facet name="sourceCaption">Tum Yetkiler</f:facet>

							<f:facet name="targetCaption">Secilen Yetkiler</f:facet>

							<p:column>
							#{authority.id}
						</p:column>

						</p:pickList>

						<f:facet name="footer">
							<p:commandButton value="Kaydet" rendered="#{empty userGroupViewBean.selectedGroup.id}" actionListener="#{userGroupViewBean.saveGroup}" update=":groupListForm" />
							<p:commandButton value="Guncelle" rendered="#{not empty userGroupViewBean.selectedGroup.id}" actionListener="#{userGroupViewBean.updateGroup}" update=":groupListForm" />
						</f:facet>

					</h:panelGrid>

				</h:form>

			</p:panel>



		</h:panelGrid>
	</ui:define>

</ui:composition>